[
  {
    "id": "A1-design-env-api",
    "title": "Design binary and CODEX_HOME API surface",
    "description": "Draft builder/API changes to accept explicit binary path (default bundled), optional CODEX_HOME override, and env-prep helper used by all spawns. Document expected directory layout under CODEX_HOME (config.toml, auth.json, .credentials.json, history.jsonl, conversations/*.jsonl, logs/codex-*.log). Produce module-level doc comments and decide on types (e.g., PathBuf for home, bool for create_dirs).",
    "status": "done",
    "dependencies": [],
    "files": ["crates/codex/src/lib.rs", "workstreams/A_binary_env/BRIEF.md"],
    "outputs": ["API proposal in comments or a short design note committed to the repo"],
    "tests": [],
    "notes": "Keep backward compatibility: existing builder defaults unchanged unless new opts are set.",
    "kickoff_prompt": "kickoff_prompts/01_initial.md"
  },
  {
    "id": "A2-implement-env-prep",
    "title": "Implement builder fields and env-prep helper",
    "description": "Add builder fields for binary_path and codex_home; implement env-prep that applies CODEX_HOME and CODEX_BINARY per Command. Ensure all spawn sites (exec/login/status/logout/basic commands) use the helper. Create helper to compute app-scoped CODEX_HOME if provided, with mkdirs as needed.",
    "status": "done",
    "dependencies": ["A1-design-env-api"],
    "files": ["crates/codex/src/lib.rs"],
    "outputs": ["Code changes compiled"],
    "tests": ["cargo test -p codex"],
    "notes": "Do not mutate parent process env; apply per-Command env()."
  },
  {
    "id": "A3-tests-docs",
    "title": "Tests and doc updates for env/binary overrides",
    "description": "Add unit tests for default binary, CODEX_BINARY override, and CODEX_HOME override applied per command. Add example or README snippet showing bundled binary + app-scoped CODEX_HOME usage (coordinate with Workstream H if desired).",
    "dependencies": ["A2-implement-env-prep"],
    "files": ["crates/codex/src/lib.rs", "crates/codex/examples"],
    "outputs": ["New tests", "Updated docs/examples"],
    "status": "done",
    "tests": ["cargo test -p codex"],
    "notes": "Prefer tempdirs in tests to avoid polluting real HOME."
  },
  {
    "id": "A4-integration-smoke",
    "title": "Integration smoke tests for env/binary overrides",
    "description": "Add end-to-end/smoke coverage proving CODEX_BINARY and CODEX_HOME are applied for every spawn site (exec, login/status/logout, MCP/app-server helpers) using a fake codex binary.",
    "dependencies": ["A3-tests-docs"],
    "files": ["crates/codex/src/lib.rs", "crates/codex/tests", "crates/codex/examples"],
    "outputs": ["Integration-style tests exercising all spawn paths with overridden env/binary"],
    "status": "done",
    "tests": ["cargo test -p codex"],
    "notes": "Use fake codex binary to assert env/args without hitting real service; cover exec, login/status/logout, MCP/app-server helpers."
  },
  {
    "id": "A5-home-path-helpers",
    "title": "Expose CODEX_HOME layout helpers",
    "description": "Expose helpers to compute CODEX_HOME layout (config/auth/.credentials/history/log paths and conversations directory) so host apps can discover files when using an app-scoped home.",
    "dependencies": ["A4-integration-smoke"],
    "files": ["crates/codex/src/lib.rs", "crates/codex/EXAMPLES.md"],
    "outputs": ["Public helper(s) describing CODEX_HOME layout and log paths"],
    "status": "done",
    "tests": ["cargo test -p codex"],
    "notes": "Keep helpers read-only unless create_home_dirs is true; document expected file locations for host apps."
  },
  {
    "id": "A6-release-polish",
    "title": "Polish and release binary/env isolation",
    "description": "Finalize docs/metadata/versioning for binary/CODEX_HOME isolation so host apps can adopt the helpers cleanly.",
    "dependencies": ["A5-home-path-helpers"],
    "files": ["crates/codex/src/lib.rs", "crates/codex/EXAMPLES.md", "crates/codex/tests", "workstreams/A_binary_env/BRIEF.md"],
    "outputs": ["Release-ready docs/notes and metadata updates"],
    "status": "done",
    "tests": ["cargo test -p codex"],
    "notes": "Focus on release polish (README/notes/version bumps) and ensure tests remain green."
  }
]
