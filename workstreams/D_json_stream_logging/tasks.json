[
  {
    "id": "D1-design-stream-types",
    "title": "Design typed JSONL event API",
    "description": "Define Rust types mirroring Codex exec --json events (thread/turn/item lifecycle, item variants: agent_message, reasoning, command_execution, file_change, mcp_tool_call, web_search, todo_list, error). Plan streaming surface (e.g., async Stream) and error types (including idle timeout). Document how --output-last-message and --output-schema integrate.",
    "status": "done",
    "dependencies": [],
    "files": ["crates/codex/src/lib.rs", "workstreams/D_json_stream_logging/BRIEF.md"],
    "outputs": ["Type definitions and API sketch (doc comments or design note)"]
  },
  {
    "id": "D2-implement-stream",
    "title": "Implement JSONL streaming and parsing",
    "description": "Implement async streaming API that spawns codex exec with --json, parses each line into typed events, flushes in real time, and propagates idle timeout errors. Ensure ANSI is disabled when parsing. Include support for --output-last-message path and apply/diff stdout/stderr/exit capture.",
    "status": "done",
    "dependencies": ["D1-design-stream-types"],
    "files": ["crates/codex/src/lib.rs"],
    "tests": ["cargo test -p codex"],
    "notes": "Use async channels/streams; avoid blocking tasks."
  },
  {
    "id": "D3-tests-example",
    "title": "Tests and example for streaming",
    "description": "Add unit/integration tests for event ordering, tool call parsing, error propagation, idle timeout behavior. Add example showing real-time consumption and writing last message file; document in README (coordinate with H).",
    "status": "done",
    "dependencies": ["D2-implement-stream"],
    "files": ["crates/codex/src/lib.rs", "crates/codex/examples"],
    "tests": ["cargo test -p codex"],
    "outputs": ["Example file", "README section"]
  },
  {
    "id": "D4-log-tee",
    "title": "File logging for streamed events",
    "description": "Add opt-in log teeing for JSON streaming so clients can persist raw event lines without breaking stdout/stderr controls. Ensure RUST_LOG handling stays correct. Include tests validating tee ordering/flush behavior and log contents for apply/diff/tool traffic.",
    "status": "done",
    "dependencies": ["D3-tests-example"],
    "files": ["crates/codex/src/lib.rs", "workstreams/D_json_stream_logging/BRIEF.md"],
    "tests": ["cargo test -p codex"],
    "outputs": ["Logging surface (builder/request options) with passing tests", "Docs/examples updated"]
  },
  {
    "id": "D5-docs-release",
    "title": "Document streaming logging surface",
    "description": "Polish crate-level docs/README around JSON streaming and the new log tee options, including RUST_LOG defaults, usage patterns, and examples. Prep any release notes needed for the logging surface.",
    "status": "done",
    "dependencies": ["D4-log-tee"],
    "files": ["README.md", "crates/codex/src/lib.rs", "workstreams/D_json_stream_logging/BRIEF.md"],
    "tests": ["cargo test -p codex"],
    "outputs": ["Documented streaming/logging usage and release notes"]
  }
]
